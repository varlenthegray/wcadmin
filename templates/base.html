{% load static %}

<!DOCTYPE html>
<!--
Template Name: NobleUI - HTML Bootstrap 5 Admin Dashboard Template
Author: NobleUI
Purchase: https://1.envato.market/nobleui_admin
Website: https://www.nobleui.com
Portfolio: https://themeforest.net/user/nobleui/portfolio
Contact: nobleui123@gmail.com
License: For each use you must have a valid license purchased only from above link in order to legally use the theme for your project.
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="West Carolina Water Treatment control panel.">
    <meta name="author" content="WCWT">
    <meta name="keywords" content="WCWT Dashboard">

    <title>WCWT Admin - {% block title %}Dashboard{% endblock %}</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <!-- End fonts -->

    <!-- jQuery -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" type="text/javascript"></script>
    <!-- end jQuery -->

    <!-- core:css -->
    <link rel="stylesheet" href="{% static 'assets/vendors/core/core.css' %}">
    <!-- endinject -->

    <!-- Plugin css for this page -->
    {% block css_plugins %}
        <link rel="stylesheet" href="{% static 'assets/vendors/datatables.net-bs4/dataTables.bootstrap4.css' %}">
    {% endblock %}

    {% block add_css_plugins %}{% endblock %}
    <!-- End plugin css for this page -->

    <!-- inject:css -->
    <link rel="stylesheet" href="{% static 'assets/fonts/feather-font/css/iconfont.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/mdi/css/materialdesignicons.min.css' %}">
    {#    <script src="{% static 'fontawesomefree/js/all.min.js' %}"></script>#}
    <!-- endinject -->

    <!-- Layout styles -->
    <link rel="stylesheet" href="{% static 'assets/css/demo2/style.css' %}">
    <!-- End layout styles -->

    <link rel="shortcut icon" href="{% static 'assets/images/favicon.png' %}" />
</head>
<body>
<div class="main-wrapper">
    <nav class="sidebar">{% include 'sidebar.html' %}</nav>

    <div class="page-wrapper">
        <nav class="navbar">
            <a href="#" class="sidebar-toggler"><i data-feather="menu"></i></a>

            <div class="navbar-content">
                <div class="search-form">
                    <h3 class="page-title">{% block page_header %}Dashboard{% endblock %}</h3>
                </div>

                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <button class="nav-link dropdown-toggle btn btn-link btn-icon-text" id="profileDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="icon-lg btn-icon-prepend" data-feather="user"></i>
                            <span>{% if user.first_name %}{{ user.first_name }} {{ user.last_name }}{% else %}{{ user.username }}{% endif %}</span>
                        </button>
                        <div class="dropdown-menu p-0" aria-labelledby="profileDropdown">
                            <div class="d-flex flex-column align-items-center border-bottom px-5 py-3">
                                <div class="text-center">
                                    <p class="tx-16 fw-bolder">{% if user.first_name %}{{ user.first_name }} {{ user.last_name }}{% else %}{{ user.username }}{% endif %}</p>
                                    <p class="tx-12 text-muted">{% if user.email %}{{ user.email }}{% else %}Unset Email{% endif %}</p>
                                </div>
                            </div>
                            <div class="d-grid gap-2 p-1">
                                <button onclick="location.href='admin/auth/user/{{ user.pk }}/change/'" type="button" class="text-start btn btn-link ms-0">
                                    <i class="me-2 icon-md" data-feather="edit"></i>
                                    <span>Edit Profile</span>
                                </button>
                                <button onclick="location.href='{% url 'logout' %}'" type="button" class="text-start btn btn-link ms-0">
                                    <i class="me-2 icon-md" data-feather="log-out"></i>
                                    <span>Log Out</span>
                                </button>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>

        <div class="page-content">
            {% block page_content %}
                <div class="row flex-grow-1">
                    <div class="col-md-3 grid-margin stretch-card">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-baseline">
                                    <h6 class="card-title mb-0"><abbr title="{{ service_past_due_date|date:"F" }}">Missed Last Month ({{ service_past_due_date|date:"M" }})</abbr></h6>
                                </div>
                                <div class="row">
                                    <div class="col-8">
                                        <h3 class="mb-2">{{ service_past_due_total.count }}</h3>
                                        <div class="d-flex align-items-baseline">
                                            <a href="{% url 'customerDueLastMonth' %}" class="text-danger">
                                                <span>See All</span>
                                                <i data-feather="arrow-right" class="icon-sm mb-1"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <span class="donut" data-peity='{ "fill": ["rgb(255,51,102)", "rgba(255,51,102,.2)"], "innerRadius": 15, "radius": 25 }'>{{ service_past_due.count }}/{{ service_past_due_total.count }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 grid-margin stretch-card">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-baseline">
                                    <h6 class="card-title mb-0"><abbr title="{{ service_due_date|date:"F" }}">Due This Month ({{ service_due_date|date:"M" }})</abbr></h6>
                                </div>
                                <div class="row">
                                    <div class="col-8">
                                        <h3 class="mb-2">{{ service_due_total.count }}</h3>
                                        <div class="d-flex align-items-baseline">
                                            <a href="{% url 'customersDueThisMonth' %}" class="text-primary">
                                                <span>See All</span>
                                                <i data-feather="arrow-right" class="icon-sm mb-1"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <span class="donut" data-peity='{ "fill": ["rgb(101, 113, 255)", "rgba(101, 113, 255,.2)"], "innerRadius": 15, "radius": 25 }'>{{ service_due.count }}/{{ service_due_total.count }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 grid-margin stretch-card">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-baseline">
                                    <h6 class="card-title mb-0"><abbr title="{{ service_coming_up_date|date:"F" }}">Service Coming Up ({{ service_coming_up_date|date:"M" }})</abbr></h6>
                                </div>
                                <div class="row">
                                    <div class="col-8">
                                        <h3 class="mb-2">{{ service_coming_up_total.count }}</h3>
                                        <div class="d-flex align-items-baseline">
                                            <a href="{% url 'customersDueNextMonth' %}" class="text-secondary">
                                                <span>See All</span>
                                                <i data-feather="arrow-right" class="icon-sm mb-1"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <span class="donut" data-peity='{ "fill": ["rgb(121, 135, 161)", "rgba(121, 135, 161,.2)"], "innerRadius": 15, "radius": 25 }'>{{ service_coming_up.count }}/{{ service_coming_up_total.count }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 grid-margin stretch-card">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-baseline">
                                    <h6 class="card-title mb-0"><abbr title="{{ service_refresh_date|date:"F Y" }}">Service Refresh ({{ service_refresh_date|date:"M Y" }})</abbr></h6>
                                </div>
                                <div class="row">
                                    <div class="col-8">
                                        <h3 class="mb-2">{{ service_refresh_total.count }}</h3>
                                        <div class="d-flex align-items-baseline">
                                            <a href="{% url 'customerDueLastYearThisMonth' %}" class="text-info">
                                                <span>See All</span>
                                                <i data-feather="arrow-right" class="icon-sm mb-1"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <span class="donut" data-peity='{ "fill": ["rgb(102, 209, 209)", "rgba(102, 209, 209,.2)"], "innerRadius": 15, "radius": 25 }'>{{ service_refresh.count }}/{{ service_refresh_total.count }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12 stretch-card">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-baseline mb-2">
                                    <h6 class="card-title mb-0">Service Due</h6>
                                    <div class="dropdown mb-2">
                                        <button class="btn p-0" type="button" id="dropdownMenuButton7" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <i class="icon-lg text-muted pb-3px" data-feather="more-horizontal"></i>
                                        </button>
                                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton7">
                                            <button id="dt_button_copy" class="dropdown-item d-flex align-items-center"><i data-feather="copy" class="icon-sm me-2"></i> <span class="">Copy</span></button>
                                            <button id="dt_button_csv" class="dropdown-item d-flex align-items-center"><i data-feather="file-text" class="icon-sm me-2"></i> <span class="">Download CSV</span></button>
                                            <button id="dt_button_excel" class="dropdown-item d-flex align-items-center"><i data-feather="columns" class="icon-sm me-2"></i> <span class="">Download Excel</span></button>
                                            <button id="dt_button_pdf" class="dropdown-item d-flex align-items-center"><i data-feather="pen-tool" class="icon-sm me-2"></i> <span class="">Download PDF</span></button>
                                            <button id="dt_button_print" class="dropdown-item d-flex align-items-center"><i data-feather="printer" class="icon-sm me-2"></i> <span class="">Print Table</span></button>
                                        </div>
                                    </div>
                                </div>

                                <div class="table-responsive">
                                    <table class="table" id="customerDatatable">
                                        <thead>
                                        <tr>
                                            <th>Actions</th>
                                            <th>Name</th>
                                            <th>Address</th>
                                            <th>Phone</th>
                                            <th>Email</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for customer in customer_list %}
                                            <tr>
                                                <td>
                                                    <a href="#" class="btn btn-inverse-primary btn-xs btn-icon" title="Open in QuickBooks">QB</a>
                                                    <a href="{% url 'viewCustomer' pk=customer.pk %}" class="btn btn-inverse-secondary btn-xs btn-icon" title="View Customer Record"><i data-feather="eye"></i></a>
                                                </td>
                                                <td>{{ customer.first_name }} {{ customer.last_name }}<br><i>{{ customer.company }}</i></td>
                                                <td>{{ customer.billing_address_1 }}<br>{{ customer.billing_city }}, {{ customer.billing_state }} {{ customer.billing_zip }}</td>
                                                <td><a href="tel:1{{ customer.main_phone }}">{{ customer.main_phone }}</a></td>
                                                <td><a href="mailto:{{ customer.email }}">{{ customer.email }}</a></td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endblock %}
        </div>

        <!-- partial:../../partials/_footer.html -->
        <footer class="footer d-flex flex-column flex-md-row align-items-center justify-content-between px-4 py-3 border-top small">
            <p class="text-muted mb-1 mb-md-0">Copyright © 2022 <a href="https://www.wcwater.com" target="_blank">WCWater</a></p>
            <p class="text-muted">Handcrafted With <i class="mb-1 text-primary mx-1 icon-sm" data-feather="heart"></i> by <a href="https://innovated.tech">Innovated Tech</a></p>
        </footer>
        <!-- partial -->
    </div>
</div>

<!-- core:js -->
<script src="{% static 'assets/vendors/core/core.js' %}"></script>
<!-- end core -->

<!-- Plugin js for this page -->
{% block page_plugins %}
    <script src="{% static 'assets/vendors/peity/jquery.peity.min.js' %}"></script>
    <script src="{% static 'assets/vendors/datatables.net/jquery.dataTables.js' %}"></script>
    <script src="{% static 'assets/vendors/datatables.net-bs4/dataTables.bootstrap4.js' %}"></script>
    <script src="{% static 'js/customerid-datatable.js' %}"></script>

    <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js"></script>
{% endblock %}

{% block add_page_plugins %}
    <script>
      $(function() {
        $('.donut').peity('donut');
      });
    </script>
{% endblock %}
<!-- End plugin js for this page -->

<!-- inject:js -->
<script src="{% static 'assets/vendors/feather-icons/feather.min.js' %}"></script>
<script src="{% static 'assets/js/template.js' %}"></script>
<!-- endinject -->

{% block page_script %}{% endblock %}
</body>
</html>