{% load widget_tweaks %}

<div class="modal-dialog modal-xl template_container">
    <div class="modal-content">
        <form method="post" id="create_edit_template_form">
            {% csrf_token %}
            {{ form.non_field_errors }}

            <div class="modal-header">
                <h5 class="modal-title"><i class="fa fa-feather-pointed"></i> Create Template</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="btn-close"></button>
            </div>

            <div class="modal-body">
                <div class="p-3 pb-0">
                    <div class="row mb-3">
                        {{ form.template_name.errors }}
                        <label class="col-md-2 col-form-label" for="{{ form.template_name.id_for_label }}">Template Name</label>
                        <div class="col-md-10">{{ form.template_name|add_class:"form-control" }}</div>
                    </div>
                    <div class="row mb-3">
                        {{ form.send_cc.errors }}
                        <label class="col-md-2 col-form-label" for="{{ form.send_cc.id_for_label }}">
                            <abbr title="Visible to recipients.">CC:</abbr>
                        </label>
                        <div class="col-md-10">
                            <select class="modal-multiple-select form-select send_cc" name="{{ form.send_cc.name }}" id="{{ form.send_cc.id_for_label }}" multiple="multiple">
                                <option value="WCWT Info <info@wcwater.com>" selected="selected">WCWT Info (info@wcwater.com)</option>
                                <option value="Dennis Warwick <dennis@wcwater.com>">Dennis Warwick (dennis@wcwater.com)</option>
                                <option value="{% if user.first_name %}{{ user.first_name }} {{ user.last_name }}{% else %}{{ user.username }}{% endif %} <{{ user.email }}>">{% if user.first_name %}{{ user.first_name }} {{ user.last_name }}{% else %}{{ user.username }}{% endif %} ({{ user.email }})</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        {{ form.subject.errors }}
                        <label class="col-md-2 col-form-label" for="{{ form.subject.id_for_label }}">Subject</label>
                        <div class="col-md-10">{{ form.subject|add_class:"form-control" }}</div>
                    </div>
                </div>
                <div class="px-3">
                    <div class="col-md-12">
                        <div class="mb-3">
                            {{ form.message.errors }}
                            <label class="form-label visually-hidden" for="{{ form.message.id_for_label }}">Email Message</label>
                            <textarea name="{{ form.message.name }}" id="{{ form.message.id_for_label }}" class="form-control">{{ form.message.value }}</textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary me-1 mb-1 btn-icon-text" type="button"><i class="fa fa-cancel fa-fw btn-icon-prepend"></i> Cancel</button>
                <button class="btn btn-danger mb-1 btn-icon-text me-auto" type="button"><i class="fa fa-trash-o fa-fw btn-icon-prepend"></i> Delete</button>
                <button class="btn btn-success me-1 mb-1 btn-icon-text" type="submit"><i class="fa fa-save fa-fw btn-icon-prepend"></i> Save</button>
            </div>
        </form>
    </div>
</div>

<script>
  $(function() {
     let message_mde = wcaSystem.setup_mde_editor('#{{ form.message.id_for_label }}'),
        multi_select = $(".send_cc");

    multi_select.select2({
      dropdownParent: $(".template_container").parent(),
    });
  })
</script>