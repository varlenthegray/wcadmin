{% extends 'communication/compose_email.html' %}

{% load static %}

{% block title %}All Templates{% endblock %}
{% block page_header %}All Templates{% endblock %}

{% block email_action %}
    <div>
        <div class="d-flex align-items-center p-3 border-bottom tx-16">
            <i class="fa fa-fw fa-table me-2"></i> All Templates

            <button type="button" class="btn btn-link btn-icon float-end" data-bs-toggle="modal" data-bs-target="#createNewTemplateModal">
                <i class="fa fa-plus-circle"></i>
            </button>
        </div>
    </div>

    <div class="p-3 pb-0">
        <table class="table table-sm">
            {% if emailtemplates_list %}
                <tr>
                    <th>Actions</th>
                    <th>Template Name</th>
                    <th>Last Updated By</th>
                    <th>Last Updated On</th>
                </tr>
                {% for template in emailtemplates_list %}
                    <tr>
                        <td></td>
                        <td>{{ template.template_name }}</td>
                        <td>{% if template.user.name %}{{ template.user.name }}{% else %}{{ template.user.username }}{% endif %}</td>
                        <td>{{ template.last_updated_on|date:'m-d-Y h:i A' }}</td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td class="text-center">
                        I checked the records... I can't find a template anywhere. Sorry.<br />
                        Want to <a href="#" data-bs-toggle="modal" data-bs-target="#createNewTemplateModal">make a new template?</a>
                    </td>
                </tr>
            {% endif %}
        </table>
    </div>

    <div class="modal fade" tabindex="-1" id="createNewTemplateModal" aria-labelledby="createNewTemplateModal" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="p-3 pb-0">
                    <div class="row mb-3">
                        <label class="col-md-2 col-form-label">Template Name</label>
                        <div class="col-md-10">
                            <input class="form-control" type="text">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label class="col-md-2 col-form-label"><abbr title="Visible to recipients.">CC:</abbr></label>
                        <div class="col-md-10">
                            <select class="modal-multiple-select form-select" multiple="multiple">
                                <option value="WCWT Info <info@wcwater.com>" selected="selected">WCWT Info (info@wcwater.com)</option>
                                <option value="Dennis Warwick <dennis@wcwater.com>">Dennis Warwick (dennis@wcwater.com)</option>
                                <option value="{% if user.first_name %}{{ user.first_name }} {{ user.last_name }}{% else %}{{ user.username }}{% endif %} <{{ user.email }}>">{% if user.first_name %}{{ user.first_name }} {{ user.last_name }}{% else %}{{ user.username }}{% endif %} ({{ user.email }})</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label class="col-md-2 col-form-label">Subject</label>
                        <div class="col-md-10">
                            <input class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <div class="px-3">
                    <div class="col-md-12">
                        <div class="mb-3">
                            <label class="form-label visually-hidden" for="simpleMdeEditor">Descriptions </label>
                            <textarea class="form-control" name="tinymce" id="simpleMdeEditor" rows="5"></textarea>
                        </div>
                    </div>
                    <div>
                        <div class="col-md-12">
                            <button class="btn btn-success me-1 mb-1 btn-icon-text" type="submit"><i class="fa fa-save fa-fw btn-icon-prepend"></i> Save</button>

                            <button class="btn btn-danger me-1 mb-1 btn-icon-text float-end" type="button"><i class="fa fa-trash-o fa-fw btn-icon-prepend"></i> Delete</button>
                        </div>
                    </div>
                </div>
            </div>

            <script>
              $(function() {
                let multi_select = $(".modal-multiple-select");

                if (multi_select.length) {
                  multi_select.select2({
                    dropdownParent: $("#createNewTemplateModal"),
                  });
                }
              })
            </script>
        </div>
    </div>
{% endblock %}