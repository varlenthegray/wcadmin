{% load static %}

<html lang="en">
<head>
    <style>
        html, body {
            width: 8.5in;
            height: 11in;
            font-size: 10pt;
        }

        table {
            font-size: 10pt;
        }

        body {
            background-color: #ffffff;
            padding: 0.5in 0.2in;
        }

        @media print {
            @page {
                margin: 0 0.2in;
            }
        }

        .contact {
            font-size: 9pt;
        }

        .certificate-header {
            border: 4px double #000;
            padding: 10px;
        }

        .legend {
            border: 1px solid #000;
            padding: 5px;
        }

        .page-break {
            page-break-after: always;
        }

        .line-group {
            font-weight: bold;
            box-shadow: inset 0 0 0 1000px rgba(13,202,240,0.25);
            text-align: center;
        }

        .definition-header {
            font-weight: bold;
            box-shadow: inset 0 0 0 1000px rgba(13,110,253,0.25);
        }
    </style>
    <title>WCWT Admin - Water Test Results</title>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" type="text/javascript"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@6.9.96/css/materialdesignicons.min.css">
</head>
<body id="system_body">
<div class="container-fluid">
    <div class="row">
        <div class="col-4 d-flex align-items-center justify-content-center">
            <img src="{% static 'images/logo_full.png' %}" class="img-fluid">
        </div>

        <div class="col-4 d-flex align-items-end justify-content-center">
            <span class="text-center pb-3">
                22 Jenkins Road<br/>
                Waynesville, NC 28785
            </span>
        </div>

        <div class="col-4">
            <table class="table table-sm contact">
                <tr>
                    <td><i class="mdi mdi-phone"></i> Phone:</td>
                    <td class="text-end">+1 (828) 648-8034</td>
                </tr>
                <tr>
                    <td><i class="mdi mdi-web"></i> Web:</td>
                    <td class="text-end">https://www.wcwater.com/</td>
                </tr>
                <tr>
                    <td><i class="mdi mdi-email"></i> Email:</td>
                    <td class="text-end">info@wcwater.com</td>
                </tr>
            </table>
        </div>
    </div>
    <hr>
    <div class="row mt-3">
        <div class="col-10 offset-1 text-center">
            <h1 class="h1 certificate-header">Certificate of Water Analysis</h1>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-6">
            <table class="table table-borderless table-sm">
                <tr>
                    <td>Report Prepared For:</td>
                    <td>{{ object.name }}</td>
                </tr>
                <tr>
                    <td>Alternate Contact:</td>
                    <td>{{ object.secondary_name }}</td>
                </tr>
                <tr>
                    <td>Email Address:</td>
                    <td>{{ object.job_site.email|default:"N/A" }}</td>
                </tr>
            </table>
        </div>

        <div class="col-4 offset-2">
            <table class="table table-borderless table-sm">
                <tr>
                    <td>Sample Date:</td>
                    <td class="text-end">{{ object.sample_date|date:'M j, Y' }}</td>
                </tr>
                <tr>
                    <td>Sample Time:</td>
                    <td class="text-end">{{ object.sample_date|date:'P' }}</td>
                </tr>
                <tr>
                    <td>Sample ID:</td>
                    <td class="text-end">{{ object.token|upper }}</td>
                </tr>
            </table>
        </div>
    </div>
    <div class="row mt-5 pb-5">
        <div class="col-12">
            <table class="table table-borderless table-sm">
                <tr>
                    <td width="21.1%">Sample Address:</td>
                    <td>{{ object.sample_address }}</td>
                </tr>
                <tr>
                    <td>Sample Point:</td>
                    <td>{{ object.sample_point }}</td>
                </tr>
            </table>
        </div>
    </div>
    <div class="row mt-5 py-4 page-break">
        <div class="col-12">
            <h5>Definition and Legend</h5>
        </div>

        <div class="col-12 legend">
            <p class="mb-2">
                This informational water quality report compares the actual test result to national standards as defined
                in the EPA's Primary and Secondary Drinking Water Regulations.
            </p>

            <table class="table collapsed table-sm">
                <tr class="definition-header">
                    <td colspan="2">Terms Used</td>
                </tr>
                <tr>
                    <td width="20%"><b>MDL:</b></td>
                    <td>The minimum detectable limit for our test to return a result.</td>
                </tr>
                <tr class="definition-header">
                    <td colspan="2">Suggested Limits</td>
                </tr>
                <tr>
                    <td><i class="mdi mdi-progress-check mdi-24px text-success"></i></td>
                    <td>The contaminant was detected between the minimum and maximum limits of the suggested range.</td>
                </tr>
                <tr>
                    <td><i class="mdi mdi-arrow-up-circle-outline mdi-24px text-danger"></i></td>
                    <td>The contaminant was above the suggested limit (not generally hazardous unless far above suggestion).</td>
                </tr>
                <tr>
                    <td><i class="mdi mdi-arrow-down-circle-outline mdi-24px text-info"></i></td>
                    <td>The contaminant was below the suggested limit (not generally hazardous unless far below suggestion).</td>
                </tr>
                <tr class="definition-header">
                    <td colspan="2">EPA Limits Enforced</td>
                </tr>
                <tr>
                    <td><i class="mdi mdi-check-circle mdi-24px text-success"></i></td>
                    <td>The contaminant was not detected in the sample above the <abbr title="Minimum Detection Level">MDL</abbr>.</td>
                </tr>
                <tr>
                    <td><i class="mdi mdi-information-variant mdi-24px text-info"></i></td>
                    <td>The contaminant was detected at or above the <abbr title="Minimum Detection Level">MDL</abbr>, but not above the referenced limit.</td>
                </tr>
                <tr>
                    <td><i class="mdi mdi-alert mdi-24px text-warning"></i></td>
                    <td>The contaminant was detected below the expected minimum levels.</td>
                </tr>
                <tr>
                    <td><i class="mdi mdi-alert-octagon mdi-24px text-danger"></i></td>
                    <td>The contaminant was detected above the EPA enforceable contaminant level.</td>
                </tr>
                <tr>
                    <td><i class="mdi mdi-close-octagon mdi-24px"></i></td>
                    <td>The contaminant was not analyzed.</td>
                </tr>
            </table>
        </div>
    </div>
    <div class="row mt-5">
        <table class="table table-sm">
            <thead>
            <tr>
                <th>Status</th>
                <th>Contaminant</th>
                <th>Result</th>
                <th>Limit</th>
                <th>Units</th>
            </tr>
            </thead>
            <tbody>
            {% for line in line_results %}
                {% ifchanged line.line_item.group %}
                <tr class="line-group">
                    <td colspan="5"><h5 class="m-0 p-0">{{ line.line_item.group.name }}</h5></td>
                </tr>
                {% endifchanged %}
                <tr>
                    <td>
                        {% if line.line_item.suggested_limit and line.result < line.line_item.maximum_limit and line.result > line.line_item.minimum_limit %}
                            <i class="mdi mdi-progress-check mdi-24px text-success"></i>
                        {% elif line.line_item.suggested_limit and line.result > line.line_item.maximum_limit and line.result > line.line_item.minimum_limit %}
                            <i class="mdi mdi-arrow-up-circle-outline mdi-24px text-danger"></i>
                        {% elif line.line_item.suggested_limit and line.result < line.line_item.maximum_limit %}
                            <i class="mdi mdi-arrow-down-circle-outline mdi-24px text-info"></i>
                        {% elif line.result > line.line_item.maximum_limit %}
                            <i class="mdi mdi-alert-octagon mdi-24px text-danger"></i>
                        {% elif line.result < line.line_item.minimum_limit and line.result != -1 %}
                            <i class="mdi mdi-alert mdi-24px text-warning"></i>
                        {% elif line.result == -1 %}
                            <i class="mdi mdi-close-octagon mdi-24px"></i>
                        {% elif line.result < line.line_item.maximum_limit and line.result > line.line_item.minimum_limit %}
                            <i class="mdi mdi-information-variant mdi-24px text-info"></i>
                        {% else %}
                            <i class="mdi mdi-check-circle mdi-24px text-success"></i>
                        {% endif %}
                    </td>
                    <td>{{ line.line_item.analyte }}</td>
                    <td>{% if line.result < 0 %}N/A{% else %}{{ line.result }}{% endif %}</td>
                    <td>{% if line.line_item.minimum_limit %}{{ line.line_item.minimum_limit }}-{% endif %}{{ line.line_item.maximum_limit }}</td>
                    <td>{{ line.line_item.unit }}</td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="5" class="text-center"><em>No test results have been logged in the system for this report yet.</em></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="row mt-5">
        <div class="col-12 text-center">
            <p>
                <em>We certify that the analyses performed for this report are accurate, and that the laboratory tests were
                    conducted by methods approved by the U.S. Environmental Protection Agency or variations of these EPA methods.</em>
            </p>
            <p><em>These test results are intended to be used for informational purposes only and may not be used for regulatory compliance.</em></p>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-12 text-center">
            <h3>West Carolina Water Treatment</h3>
            <h5>22 Jenkins Road • Waynesville • NC • 28785</h5>
        </div>
    </div>
</div>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
</html>